spring.application.name=video-service
server.port=${SERVER_PORT:8086}

# --- Banco ---
spring.datasource.url=${DB_URL}
spring.datasource.username=${DB_USER}
spring.datasource.password=${DB_PASS}
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=true
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect
spring.jpa.open-in-view=false

# --- Bunny Stream (gerenciado) ---
bunny.stream.library-id=479707
bunny.stream.api-key=${BUNNY_STREAM_API_KEY}
bunny.stream.signingKey=
bunny.stream.tokenTtlSeconds=3600
bunny.stream.cdn-host=vz-c05b38f9-149.b-cdn.net

# Rate-limit simples (opcional)
app.rate-limit.limit=300
app.rate-limit.window-millis=10000
app.rate-limit.include[0]=/api/videos
app.rate-limit.exclude[0]=/health

# Multipart grande
spring.servlet.multipart.max-file-size=512MB
spring.servlet.multipart.max-request-size=512MB

# Tomcat: não engasgar em bodies grandes
server.tomcat.max-swallow-size=-1
server.tomcat.max-http-form-post-size=-1

# Timeout de conexão do Tomcat (aceitar handshake)
server.connection-timeout=60s

# Aumentar limite de header (proxies podem aumentar cabeçalhos)
server.max-http-request-header-size=32KB

# Access log bem útil p/ uploads
server.tomcat.accesslog.enabled=true
server.tomcat.accesslog.pattern=%{X-Forwarded-For}i %a %h %t "%r" %s %b %D "%{CF-Ray}i"

# Logs (DEBUG enquanto investiga; depois troque p/ INFO)
logging.level.org.springframework.web=DEBUG
logging.level.org.apache.coyote.http11=DEBUG
# logging.level.org.springframework.web=INFO
# logging.level.org.apache.coyote.http11=INFO
